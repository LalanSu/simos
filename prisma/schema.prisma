generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider          = "mysql"
  url               = env("DATABASE_URL")
  /* shadowDatabaseUrl = env("SHADOW_DATABASE_URL") */
}

enum Role {
  admin
  user
}

model User {
  id            String    @id @default(uuid())
  name          String
  email         String    @unique
  emailVerified DateTime?
  password      String
  role          Role      @default(user)
  image         String?
}

model TBL_USR_ROLES {
  Id_Rol      Int      @id @default(autoincrement())
  Rol         String   @db.VarChar(50)
  Descripcion String   @db.VarChar(70)
  usuarios    TBL_USUARIO[]
  permisos    TBL_PERMISOS[]
}

model TBL_OBJETOS {
  Id_Objeto    Int      @id @default(autoincrement())
  Objeto       String   @db.VarChar(70)
  Descripcion  String   @db.VarChar(70)
  Tipo_Objeto  String   @db.VarChar(20)
  permisos     TBL_PERMISOS[]
}

model TBL_USUARIO {
  Id_Usuario           Int      @id @default(autoincrement())
  Usuario              String   @db.VarChar(50)
  Nombre_Usuario       String   @db.VarChar(70)
  Estado_Usuario       String   @db.VarChar(70)
  Contrasenia          String   @db.VarChar(255)
  Primer_Ingreso       Int
  Correo_Electronico   String   @db.VarChar(50)
  tbl_usr_roles_id_rol Int
  rol                  TBL_USR_ROLES @relation(fields: [tbl_usr_roles_id_rol], references: [Id_Rol])
  historial_contra     TBL_HIST_CONTRASENIA[]
}

model TBL_HIST_CONTRASENIA {
  Id_Historial_Contra  Int      @id @default(autoincrement())
  Contrasenia         String?   @db.VarChar(255)
  tbl_usuario_id_usuario Int
  usuario             TBL_USUARIO @relation(fields: [tbl_usuario_id_usuario], references: [Id_Usuario])
}

model TBL_PERMISOS {
  Id_Permisos          Int      @id @default(autoincrement())
  Permiso_Insertar     String   @db.VarChar(50)
  Permiso_Consultar    String   @db.VarChar(50)
  Permiso_Actualizar   String   @db.VarChar(50)
  Permiso_Eliminar     String   @db.VarChar(50)
  Creador             String   @db.VarChar(50)
  Modificado_Por      String   @db.VarChar(50)
  Fecha_Creacion      DateTime @db.DateTime(0)
  Fecha_Modificacion  DateTime @updatedAt @db.Timestamp(0)
  tbl_usr_roles_id_rol Int
  tbl_objetos_id_objeto Int
  rol                  TBL_USR_ROLES @relation(fields: [tbl_usr_roles_id_rol], references: [Id_Rol])
  objeto               TBL_OBJETOS @relation(fields: [tbl_objetos_id_objeto], references: [Id_Objeto])
}

